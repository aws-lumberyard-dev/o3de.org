<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Open 3D Engine Atom Gem API Reference: AZ::RHI::FrameGraphCompiler Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Open 3D Engine Atom Gem API Reference
   &#160;<span id="projectnumber">2107.1 (Developer Preview)</span>
   </div>
   <div id="projectbrief">O3DE is an open-source, fully-featured, high-fidelity, modular 3D engine for building games and simulations, available to every industry.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_a_z.html">AZ</a></li><li class="navelem"><b>RHI</b></li><li class="navelem"><a class="el" href="class_a_z_1_1_r_h_i_1_1_frame_graph_compiler.html">FrameGraphCompiler</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_a_z_1_1_r_h_i_1_1_frame_graph_compiler-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">AZ::RHI::FrameGraphCompiler Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;FrameGraphCompiler.h&gt;</code></p>

<p>Inherits <a class="el" href="class_a_z_1_1_r_h_i_1_1_device_object.html">AZ::RHI::DeviceObject</a>.</p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0667e4179e58be076fd8e5bba9288728"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0667e4179e58be076fd8e5bba9288728"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>AZ_RTTI</b> (<a class="el" href="class_a_z_1_1_r_h_i_1_1_frame_graph_compiler.html">FrameGraphCompiler</a>,&quot;{A126F362-C163-432E-94DE-61AA4DFDF102}&quot;, Object)</td></tr>
<tr class="separator:a0667e4179e58be076fd8e5bba9288728"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4be4f9d99e7c9931f82fe714ff8e2b5c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4be4f9d99e7c9931f82fe714ff8e2b5c"></a>
ResultCode&#160;</td><td class="memItemRight" valign="bottom"><b>Init</b> (<a class="el" href="class_a_z_1_1_r_h_i_1_1_device.html">Device</a> &amp;device)</td></tr>
<tr class="separator:a4be4f9d99e7c9931f82fe714ff8e2b5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56119379ce1796077c4f16f05e8c2ce1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a56119379ce1796077c4f16f05e8c2ce1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_z_1_1_r_h_i_1_1_frame_graph_compiler.html#a56119379ce1796077c4f16f05e8c2ce1">Shutdown</a> () overridefinal</td></tr>
<tr class="memdesc:a56119379ce1796077c4f16f05e8c2ce1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears the current bound device to null. <br/></td></tr>
<tr class="separator:a56119379ce1796077c4f16f05e8c2ce1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08ddc09a7843f299d4739c1a7c45c617"><td class="memItemLeft" align="right" valign="top">MessageOutcome&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_z_1_1_r_h_i_1_1_frame_graph_compiler.html#a08ddc09a7843f299d4739c1a7c45c617">Compile</a> (const <a class="el" href="struct_a_z_1_1_r_h_i_1_1_frame_graph_compile_request.html">FrameGraphCompileRequest</a> &amp;request)</td></tr>
<tr class="separator:a08ddc09a7843f299d4739c1a7c45c617"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_a_z_1_1_r_h_i_1_1_device_object"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_a_z_1_1_r_h_i_1_1_device_object')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_a_z_1_1_r_h_i_1_1_device_object.html">AZ::RHI::DeviceObject</a></td></tr>
<tr class="memitem:a1b46c9e76b49ec5a7b69c4cfafb6cebd inherit pub_methods_class_a_z_1_1_r_h_i_1_1_device_object"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1b46c9e76b49ec5a7b69c4cfafb6cebd"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>AZ_RTTI</b> (<a class="el" href="class_a_z_1_1_r_h_i_1_1_device_object.html">DeviceObject</a>,&quot;{17D34F71-944C-4AF5-9823-627474C4C0A6}&quot;, Object)</td></tr>
<tr class="separator:a1b46c9e76b49ec5a7b69c4cfafb6cebd inherit pub_methods_class_a_z_1_1_r_h_i_1_1_device_object"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af00cb1ac6436a4100cdfba458a959d8c inherit pub_methods_class_a_z_1_1_r_h_i_1_1_device_object"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af00cb1ac6436a4100cdfba458a959d8c"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_z_1_1_r_h_i_1_1_device_object.html#af00cb1ac6436a4100cdfba458a959d8c">IsInitialized</a> () const </td></tr>
<tr class="memdesc:af00cb1ac6436a4100cdfba458a959d8c inherit pub_methods_class_a_z_1_1_r_h_i_1_1_device_object"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether the device object is initialized. <br/></td></tr>
<tr class="separator:af00cb1ac6436a4100cdfba458a959d8c inherit pub_methods_class_a_z_1_1_r_h_i_1_1_device_object"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf10f418d4ddfcb1ba06994269a0dbfc inherit pub_methods_class_a_z_1_1_r_h_i_1_1_device_object"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_a_z_1_1_r_h_i_1_1_device.html">Device</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_z_1_1_r_h_i_1_1_device_object.html#abf10f418d4ddfcb1ba06994269a0dbfc">GetDevice</a> () const </td></tr>
<tr class="separator:abf10f418d4ddfcb1ba06994269a0dbfc inherit pub_methods_class_a_z_1_1_r_h_i_1_1_device_object"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_a_z_1_1_r_h_i_1_1_object"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_a_z_1_1_r_h_i_1_1_object')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_a_z_1_1_r_h_i_1_1_object.html">AZ::RHI::Object</a></td></tr>
<tr class="memitem:a458422c2e78bdc3d64d901e1c347ab0b inherit pub_methods_class_a_z_1_1_r_h_i_1_1_object"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a458422c2e78bdc3d64d901e1c347ab0b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>AZ_RTTI</b> (<a class="el" href="class_a_z_1_1_r_h_i_1_1_object.html">Object</a>,&quot;{E43378F1-2331-4173-94B8-990ED20E6003}&quot;)</td></tr>
<tr class="separator:a458422c2e78bdc3d64d901e1c347ab0b inherit pub_methods_class_a_z_1_1_r_h_i_1_1_object"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9486615a64c9e9f0ce2c6eb0bbab2d35 inherit pub_methods_class_a_z_1_1_r_h_i_1_1_object"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9486615a64c9e9f0ce2c6eb0bbab2d35"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_z_1_1_r_h_i_1_1_object.html#a9486615a64c9e9f0ce2c6eb0bbab2d35">SetName</a> (const Name &amp;name)</td></tr>
<tr class="memdesc:a9486615a64c9e9f0ce2c6eb0bbab2d35 inherit pub_methods_class_a_z_1_1_r_h_i_1_1_object"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the name of the object. <br/></td></tr>
<tr class="separator:a9486615a64c9e9f0ce2c6eb0bbab2d35 inherit pub_methods_class_a_z_1_1_r_h_i_1_1_object"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a190fbf8596c65545c2bb2d713c7f7c89 inherit pub_methods_class_a_z_1_1_r_h_i_1_1_object"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a190fbf8596c65545c2bb2d713c7f7c89"></a>
const Name &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_z_1_1_r_h_i_1_1_object.html#a190fbf8596c65545c2bb2d713c7f7c89">GetName</a> () const </td></tr>
<tr class="memdesc:a190fbf8596c65545c2bb2d713c7f7c89 inherit pub_methods_class_a_z_1_1_r_h_i_1_1_object"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the name set on the object by SetName. <br/></td></tr>
<tr class="separator:a190fbf8596c65545c2bb2d713c7f7c89 inherit pub_methods_class_a_z_1_1_r_h_i_1_1_object"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40cab6a10612d7fdf473957d9f5b8d9d inherit pub_methods_class_a_z_1_1_r_h_i_1_1_object"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a40cab6a10612d7fdf473957d9f5b8d9d"></a>
uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_z_1_1_r_h_i_1_1_object.html#a40cab6a10612d7fdf473957d9f5b8d9d">use_count</a> ()</td></tr>
<tr class="memdesc:a40cab6a10612d7fdf473957d9f5b8d9d inherit pub_methods_class_a_z_1_1_r_h_i_1_1_object"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the current use count of the object. <br/></td></tr>
<tr class="separator:a40cab6a10612d7fdf473957d9f5b8d9d inherit pub_methods_class_a_z_1_1_r_h_i_1_1_object"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="class_a_z_1_1_r_h_i_1_1_frame_graph_compiler.html">FrameGraphCompiler</a> controls compilation of <a class="el" href="class_a_z_1_1_r_h_i_1_1_frame_graph.html">FrameGraph</a> each frame. <a class="el" href="class_a_z_1_1_r_h_i_1_1_frame_scheduler.html">FrameScheduler</a> owns and drives an instance of this class, so end-users should never need to interact with it directly. Platform implementations, on the other hand, are required to override this class in order to perform platform-specific scope construction.</p>
<p>The compiler is designed to be invoked every frame; the graph is simply rebuilt each time. The compile operation is also done on a single thread; so overhead should be kept to a minimum.</p>
<p>The RHI base class performs platform-independent compilation before passing control down to the derived platform implementation. The provided <a class="el" href="class_a_z_1_1_r_h_i_1_1_frame_graph.html">FrameGraph</a> instance is compiled in-place according to the following phases: </p>
<pre class="fragment"> == Cross-Queue Graph Edges == 
</pre><p><a class="el" href="class_a_z_1_1_r_h_i_1_1_frame_graph.html">FrameGraph</a> contains a graph of <a class="el" href="class_a_z_1_1_r_h_i_1_1_scope.html">Scope</a> instances. Scopes are topologically sorted prior to compilation as part of the graph construction process. Scopes associate directly to a "Hardware Queue Class": Graphics, Compute, or Copy. These three queue classes must be synchronized between each other. To make this easier on platforms, the base compiler takes the topologically flattened graph and collates it into three independent sorted lists&ndash;one for each queue class. Then, a queue-centric producer-consumer graph is constructed across the scopes. Specifically:</p>
<p>class <a class="el" href="class_a_z_1_1_r_h_i_1_1_scope.html">Scope</a> { Scope* m_producersByQueue[HardwareQueueClassCount]; Scope* m_consumersByQueue[HardwareQueueClassCount]; };</p>
<p>This graph makes it possible to walk along a queue or across queue boundaries at dependency points. Each platform can then trivially crawl this graph to derive signal / wait fence values, if applicable. </p>
<pre class="fragment"> == Transient Attachments ==
</pre><p>Transient attachments are intra-frame and do not persist after the frame ends and can take the form of buffers or images. These attachments are owned by a <a class="el" href="class_a_z_1_1_r_h_i_1_1_transient_attachment_pool.html">TransientAttachmentPool</a>; every frame, the pool is reset. Since attachments are always declared for usage on scopes, its full usage chain&ndash;and thus its lifetime across the frame&ndash;is immediately available.</p>
<p>The phase first constructs the scope lifetime for each attachment. Then, memory for each attachment is allocated from the transient attachment pool, one scope at a time. This allows the pool to record begin and end usages for each attachment per scope. Internally, the platform implementation can use this information to place aliased resources onto one or more heaps of memory.</p>
<p>One important consideration is dealing with aliasing across queue boundaries. Since queues must be synchronized between each other, attempting to alias memory across two queues at the same time will produce a race condition. To solve this, when faced with a queue overlap, the compiler extends the lifetime of the attachment until a join operation occurs. However, the compiler picks a single queue which is allowed to alias during that region by inspecting which one will see the biggest potential gain. This way, some aliasing is still allowed when async compute / copy is in use.</p>
<p>Finally, because the resources themselves are effectively re-created each frame, a cache of views is kept inside the compiler. The cache is big enough to avoid having to re-create views every frame, but bounded in order to release entries old views. </p>
<pre class="fragment"> == Platform-Specific Compilation ==
</pre><p>Finally, the compiler calls into the platform-specific compile method, which hands control over to the derived class. The platform implementation is expected to further process the frame graph and scope data down to platform-specific actions. For example:</p>
<p>1) Derive transition barriers by walking the scope attachment chain on each frame attachment. 2) Derive queue fence values by walking the queue-centric scope graph. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a08ddc09a7843f299d4739c1a7c45c617"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MessageOutcome AZ::RHI::FrameGraphCompiler::Compile </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_a_z_1_1_r_h_i_1_1_frame_graph_compile_request.html">FrameGraphCompileRequest</a> &amp;&#160;</td>
          <td class="paramname"><em>request</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compiles the frame graph. Platform-independent compilation is done first according to the provided flags. At the end, the platform-dependent compilation method is invoked. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>Gems/Atom/RHI/Code/Include/Atom/RHI/FrameGraphCompiler.h</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Mar 10 2023 22:41:36 for Open 3D Engine Atom Gem API Reference by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
